# NGINX Ingress Controller - 로컬 단일노드 환경 설정
controller:
  # hostNetwork 모드로 80/443 직접 바인딩
  hostNetwork: true
  hostPort:
    enabled: true
    ports:
      http: 80
      https: 443

  # DaemonSet으로 배포 (모든 노드에서 실행)
  kind: DaemonSet

  # 최소 리소스
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

  # NodePort 서비스 사용 (hostNetwork와 함께)
  service:
    type: NodePort
    nodePorts:
      http: 30080
      https: 30443

  # IngressClass 설정
  ingressClassResource:
    name: nginx
    enabled: true
    default: true

  # 로그 레벨
  config:
    log-format-upstream: '$remote_addr - $remote_user [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" $request_length $request_time [$proxy_upstream_name] $upstream_addr $upstream_response_length $upstream_response_time $upstream_status $req_id'

  # 컨트롤플레인 노드에도 배포
  tolerations:
    - key: node-role.kubernetes.io/control-plane
      operator: Exists
      effect: NoSchedule
    - key: node-role.kubernetes.io/master
      operator: Exists
      effect: NoSchedule

# Admission webhook 비활성화 (단일노드 환경)
admissionWebhooks:
  enabled: false
