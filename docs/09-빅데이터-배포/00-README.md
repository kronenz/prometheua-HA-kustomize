# ë¹…ë°ì´í„° ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ì™„ë£Œ ë³´ê³ ì„œ

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

**ëª©ì **: DataOps ëŒ€ì‹œë³´ë“œë¥¼ ìœ„í•œ ë¹…ë°ì´í„° ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ë° ë©”íŠ¸ë¦­ ìˆ˜ì§‘
**ë°°í¬ ì¼ì‹œ**: 2025-11-07
**í´ëŸ¬ìŠ¤í„°**: cluster-01-central (192.168.101.194)
**ë„¤ì„ìŠ¤í˜ì´ìŠ¤**: `spark`, `kafka`

---

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. Apache Spark ë°°í¬ (ì„±ê³µ)

**ë°°í¬ ìƒíƒœ**: âœ… ì™„ë£Œ
**ë²„ì „**: Spark 3.5.3 (Bitnami Helm Chart 10.0.3)

#### ë°°í¬ëœ ë¦¬ì†ŒìŠ¤
- **Master**: 1 replica (Running)
- **Worker**: 2 replicas (Running)
- **ì´ë¯¸ì§€**: public.ecr.aws/bitnami/spark:3.5.3
- **ServiceMonitor**: Prometheus ë©”íŠ¸ë¦­ ìˆ˜ì§‘ í™œì„±í™”

#### ê²€ì¦ ê²°ê³¼
- Pod ìƒíƒœ: spark-master-0, spark-worker-0, spark-worker-1 ëª¨ë‘ Running
- ë©”íŠ¸ë¦­: metrics_master_aliveWorkers_Value = 2
- í…ŒìŠ¤íŠ¸ Job: Pi is roughly 3.140815914081591 (ì„±ê³µ)

### 2. ì£¼ìš” ì„±ê³¼

âœ… **ì´ë¯¸ì§€ ì €ì¥ì†Œ ë¬¸ì œ í•´ê²°**: Docker Hub â†’ Amazon ECR Public Gallery
âœ… **Prometheus ë©”íŠ¸ë¦­ ìˆ˜ì§‘ êµ¬ì„±**: ServiceMonitor + PrometheusServlet
âœ… **í…ŒìŠ¤íŠ¸ Job ì‹¤í–‰ ì„±ê³µ**: Spark Pi ì˜ˆì œ ì •ìƒ ì‹¤í–‰
âœ… **ë¬¸ì„œí™” ì™„ë£Œ**: 5ê°œ ê°€ì´ë“œ ë¬¸ì„œ ì‘ì„±
âœ… **ì•ˆì •ì„± ê²€ì¦**: 65ë¶„ ì´ìƒ ë¬´ì¤‘ë‹¨ ìš´ì˜

## âš ï¸ ë°°í¬í•˜ì§€ ì•Šì€ ì• í”Œë¦¬ì¼€ì´ì…˜

### Apache Kafka & Apache Airflow

**ê²°ì •**: ë‹¨ì¼ ë…¸ë“œ í´ëŸ¬ìŠ¤í„° ë¦¬ì†ŒìŠ¤ ì œì•½ìœ¼ë¡œ ë°°í¬ ë³´ë¥˜

**ì´ìœ **:
- CPU 87% ì´ë¯¸ í• ë‹¹ë¨ (Kafka ì¶”ê°€ ì‹œ 500m+ í•„ìš”)
- Kafka KRaft ë‹¨ì¼ ë…¸ë“œ êµ¬ì„± ë³µì¡ë„ ë†’ìŒ
- Airflow PostgreSQL + Scheduler ë¦¬ì†ŒìŠ¤ ê²½í•©

**ëŒ€ì•ˆ**:
- **í˜„ì¬**: Spark ë©”íŠ¸ë¦­ë§Œìœ¼ë¡œ ëŒ€ì‹œë³´ë“œ êµ¬ì„±
- **í–¥í›„**: 3-Node ì´ìƒ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ë°°í¬
- **ìƒì„¸**: [04-ë°°í¬-ì „ëµ-ë°-ê¶Œì¥ì‚¬í•­.md](./04-ë°°í¬-ì „ëµ-ë°-ê¶Œì¥ì‚¬í•­.md) ì°¸ê³ 

## ğŸ“š ë¬¸ì„œ êµ¬ì¡°

ì´ ë””ë ‰í† ë¦¬ì—ëŠ” ë‹¤ìŒ ë¬¸ì„œë“¤ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

- **00-README.md** (ì´ íŒŒì¼): ì „ì²´ í”„ë¡œì íŠ¸ ìš”ì•½ ë° ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
- **01-ë°°í¬-ê°€ì´ë“œ.md**: BigData ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ ìƒì„¸ ì ˆì°¨
- **02-ë°°í¬-ìƒíƒœ.md**: í˜„ì¬ ë°°í¬ ìƒíƒœ, ì´ìŠˆ, íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
- **03-ë©”íŠ¸ë¦­-ê°€ì´ë“œ.md**: ìˆ˜ì§‘ëœ ë©”íŠ¸ë¦­ ë° PromQL ì¿¼ë¦¬ ê°€ì´ë“œ
- **04-ë°°í¬-ì „ëµ-ë°-ê¶Œì¥ì‚¬í•­.md**: â­ Kafka/Airflow ë°°í¬ ì‹¤íŒ¨ ë¶„ì„ ë° í”„ë¡œë•ì…˜ ê¶Œì¥ì‚¬í•­

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### Spark ìƒíƒœ í™•ì¸
\`\`\`bash
kubectl get pods -n spark
kubectl get svc -n spark
\`\`\`

### Grafana ì ‘ì†
\`\`\`bash
# URL
http://grafana.k8s-cluster-01.miribit.lab

# ê¸°ë³¸ ê³„ì •
Username: admin
Password: admin123
\`\`\`

### Spark Job ì‹¤í–‰
\`\`\`bash
kubectl exec -n spark spark-worker-0 -- \
  spark-submit --master spark://spark-master-svc:7077 \
  --class org.apache.spark.examples.SparkPi \
  /opt/bitnami/spark/examples/jars/spark-examples_2.12-3.5.3.jar 100
\`\`\`

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. **Grafana ëŒ€ì‹œë³´ë“œ ê²€ì¦** - Kubernetes + Spark ë©”íŠ¸ë¦­ í™•ì¸
2. **PromQL ì¿¼ë¦¬ ìˆ˜ì •** - Kafka â†’ Spark ë©”íŠ¸ë¦­ìœ¼ë¡œ ëŒ€ì²´
3. **ì‹¤ì œ Spark Job ì‹¤í–‰** - í”„ë¡œë•ì…˜ ì›Œí¬ë¡œë“œ í…ŒìŠ¤íŠ¸

ìì„¸í•œ ë‚´ìš©ì€ ê° ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.
