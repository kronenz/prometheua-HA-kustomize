apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-dataops-infrastructure-v2
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
data:
  dataops-infrastructure-v2.json: |
    {
      "uid": "dataops-infrastructure-v2",
      "title": "ğŸ—ï¸ DataOps - Infrastructure Health",
      "tags": ["dataops", "infrastructure", "baremetal", "kubernetes", "v2"],
      "timezone": "browser",
      "schemaVersion": 16,
      "version": 4,
      "refresh": "30s",
      "editable": true,
      "style": "dark",
      "folder": "Infrastructure",
      "folderUid": "dataops-infrastructure-folder",
      "panels": [
        {
          "type": "text",
          "title": "",
          "gridPos": {"h": 4, "w": 24, "x": 0, "y": 0},
          "transparent": true,
          "options": {
            "mode": "html",
            "content": "<div style='padding: 24px; background: rgba(31, 41, 55, 0.6); border-radius: 8px; border-left: 4px solid #5B8DEE;'><div style='display: flex; justify-content: space-between; align-items: center;'><div><h2 style='margin: 0 0 8px 0; font-size: 24px; font-weight: 600; color: #F9FAFB;'>ğŸ—ï¸ Infrastructure Health</h2><p style='margin: 0; font-size: 14px; color: #9CA3AF;'>ë² ì–´ë©”íƒˆ ì„œë²„, ë„¤íŠ¸ì›Œí¬, ìŠ¤í† ë¦¬ì§€, Kubernetes í´ëŸ¬ìŠ¤í„° ì „ì²´ ì¸í”„ë¼ ìƒíƒœ</p></div><div><a href='/d/dataops-executive-v2/executive-summary?orgId=1' style='display: inline-block; padding: 10px 20px; background: rgba(91, 141, 238, 0.15); border: 1px solid #5B8DEE; border-radius: 6px; color: #5B8DEE; text-decoration: none; font-size: 14px; font-weight: 500; transition: all 0.2s;' onmouseover='this.style.background=\"rgba(91, 141, 238, 0.25)\";' onmouseout='this.style.background=\"rgba(91, 141, 238, 0.15)\";'>â† Executive</a></div></div></div>"
          }
        },
        {
          "type": "row",
          "title": "ë¬¼ë¦¬ ì„œë²„ ìƒíƒœ",
          "gridPos": {"h": 1, "w": 24, "x": 0, "y": 4},
          "collapsed": false
        },
        {
          "type": "gauge",
          "title": "ì„œë²„ í‰ê·  ì˜¨ë„",
          "description": "**ë² ì–´ë©”íƒˆ ì„œë²„ì˜ CPU/ì‹œìŠ¤í…œ í‰ê·  ì˜¨ë„**\n\nì„œë²„ í•˜ë“œì›¨ì–´ ì„¼ì„œì—ì„œ ìˆ˜ì§‘í•œ ì˜¨ë„ ì •ë³´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.\n\n**ì„ê³„ê°’**:\n- **0-60Â°C**: ì •ìƒ (ë…¹ìƒ‰)\n- **60-75Â°C**: ì£¼ì˜ - ì¿¨ë§ ì‹œìŠ¤í…œ ì ê²€ í•„ìš” (í™©ìƒ‰)\n- **75Â°C ì´ìƒ**: ìœ„í—˜ - ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš” (ì ìƒ‰)\n\n**ì¡°ì¹˜ ì‚¬í•­**:\n- 75Â°C ì´ˆê³¼: ì„œë²„ ì¿¨ë§ íŒ¬ ìƒíƒœ í™•ì¸, ë°ì´í„°ì„¼í„° ëƒ‰ë°© ì ê²€\n- ì§€ì†ì  ê³ ì˜¨: ì›Œí¬ë¡œë“œ ë¶„ì‚° ë˜ëŠ” í•˜ë“œì›¨ì–´ êµì²´ ê³ ë ¤\n\n**ë©”íŠ¸ë¦­**: `node_hwmon_temp_celsius`",
          "gridPos": {"h": 6, "w": 4, "x": 0, "y": 5},
          "targets": [{
            "expr": "avg(node_hwmon_temp_celsius)",
            "refId": "A"
          }],
          "options": {
            "showThresholdLabels": false,
            "showThresholdMarkers": true
          },
          "fieldConfig": {
            "defaults": {
              "unit": "celsius",
              "min": 0,
              "max": 100,
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "#10B981"},
                  {"value": 60, "color": "#F59E0B"},
                  {"value": 75, "color": "#EF4444"}
                ]
              }
            }
          }
        },
        {
          "type": "stat",
          "title": "ê°€ë™ ì¤‘ì¸ ë…¸ë“œ",
          "description": "**í˜„ì¬ ê°€ë™ ì¤‘ì¸ ë¬¼ë¦¬ ì„œë²„ ë…¸ë“œ ìˆ˜**\n\nNode Exporterë¡œë¶€í„° ë©”íŠ¸ë¦­ì„ ì •ìƒì ìœ¼ë¡œ ìˆ˜ì§‘í•˜ê³  ìˆëŠ” ë…¸ë“œì˜ ê°œìˆ˜ì…ë‹ˆë‹¤.\n\n**ì •ìƒ ìƒíƒœ**: ì „ì²´ ë…¸ë“œ ìˆ˜ì™€ ì¼ì¹˜\n\n**ê²½ê³ **:\n- ë…¸ë“œ ìˆ˜ ê°ì†Œ: ì„œë²„ ë‹¤ìš´ ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ ë‹¨ì ˆ\n- ì¦‰ì‹œ í•´ë‹¹ ë…¸ë“œ ìƒíƒœ í™•ì¸ í•„ìš”\n\n**ë©”íŠ¸ë¦­**: `up{job=\\\"node-exporter\\\"}==1`",
          "gridPos": {"h": 6, "w": 4, "x": 4, "y": 5},
          "targets": [{
            "expr": "count(up{job=\"node-exporter\"} == 1)",
            "refId": "A"
          }],
          "options": {
            "colorMode": "background",
            "textMode": "value_and_name"
          },
          "fieldConfig": {
            "defaults": {
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "rgba(239, 68, 68, 0.15)"},
                  {"value": 3, "color": "rgba(245, 158, 11, 0.15)"},
                  {"value": 4, "color": "rgba(16, 185, 129, 0.15)"}
                ]
              }
            }
          }
        },
        {
          "type": "stat",
          "title": "ì „ë ¥ ì†Œë¹„",
          "description": "**ì „ì²´ ì„œë²„ì˜ ì‹¤ì‹œê°„ ì „ë ¥ ì†Œë¹„ëŸ‰**\n\në² ì–´ë©”íƒˆ ì„œë²„ì˜ ì´ ì „ë ¥ ì‚¬ìš©ëŸ‰ì„ Watts ë‹¨ìœ„ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.\n\n**í™œìš©**:\n- ì „ë ¥ ì˜ˆì‚° ê´€ë¦¬ ë° ë¹„ìš© ì‚°ì •\n- PUE(Power Usage Effectiveness) ê³„ì‚°\n- ì „ë ¥ íš¨ìœ¨ì„± ìµœì í™”\n\n**ìµœì í™”**:\n- ìœ íœ´ ì„œë²„ ì „ì› ê´€ë¦¬\n- ì›Œí¬ë¡œë“œ ìŠ¤ì¼€ì¤„ë§ìœ¼ë¡œ í”¼í¬ ì‹œê°„ ë¶„ì‚°\n- ì—ë„ˆì§€ íš¨ìœ¨ì ì¸ í•˜ë“œì›¨ì–´ ì„ ì •\n\n**ë©”íŠ¸ë¦­**: `node_power_usage_watts`",
          "gridPos": {"h": 6, "w": 4, "x": 8, "y": 5},
          "targets": [{
            "expr": "sum(node_power_usage_watts)",
            "refId": "A"
          }],
          "fieldConfig": {
            "defaults": {
              "unit": "watt",
              "color": {"mode": "fixed", "fixedColor": "#5B8DEE"}
            }
          }
        },
        {
          "type": "stat",
          "title": "Memory ECC Errors",
          "description": "**24ì‹œê°„ ë™ì•ˆ ë°œìƒí•œ ECC ë©”ëª¨ë¦¬ ì˜¤ë¥˜ ìˆ˜**\n\nECC(Error Correcting Code) ë©”ëª¨ë¦¬ì˜ ìˆ˜ì • ë¶ˆê°€ëŠ¥í•œ ì˜¤ë¥˜ ë°œìƒ ê±´ìˆ˜ì…ë‹ˆë‹¤.\n\n**ì •ìƒ**: 0ê±´\n\n**ê²½ê³ **:\n- **1ê±´ ì´ìƒ**: ë©”ëª¨ë¦¬ ëª¨ë“ˆ ë¶ˆì•ˆì •\n- **ì§€ì† ë°œìƒ**: í•´ë‹¹ ë©”ëª¨ë¦¬ ëª¨ë“ˆ êµì²´ í•„ìš”\n\n**ì˜í–¥**:\n- ë°ì´í„° ë¬´ê²°ì„± ì €í•˜\n- ì‹œìŠ¤í…œ í¬ë˜ì‹œ ê°€ëŠ¥ì„±\n- ì›Œí¬ë¡œë“œ ì‹ ë¢°ì„± ê°ì†Œ\n\n**ì¡°ì¹˜**: ì¦‰ì‹œ í•˜ë“œì›¨ì–´ ì ê²€ ë° ë©”ëª¨ë¦¬ êµì²´\n\n**ë©”íŠ¸ë¦­**: `node_edac_uncorrectable_errors_total`",
          "gridPos": {"h": 6, "w": 4, "x": 12, "y": 5},
          "targets": [{
            "expr": "sum(increase(node_edac_uncorrectable_errors_total[24h]))",
            "refId": "A"
          }],
          "fieldConfig": {
            "defaults": {
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "rgba(16, 185, 129, 0.15)"},
                  {"value": 1, "color": "rgba(239, 68, 68, 0.15)"}
                ]
              }
            }
          }
        },
        {
          "type": "stat",
          "title": "RAID ìƒíƒœ",
          "description": "**RAID ì–´ë ˆì´ì˜ ì •ìƒ ì‘ë™ ë””ìŠ¤í¬ ìˆ˜**\n\nRAID êµ¬ì„±ì—ì„œ Active ìƒíƒœì¸ ë””ìŠ¤í¬ì˜ ê°œìˆ˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.\n\n**ì •ìƒ**: RAID êµ¬ì„±ì˜ ì „ì²´ ë””ìŠ¤í¬ ìˆ˜ì™€ ì¼ì¹˜\n\n**ê²½ê³ **:\n- ë””ìŠ¤í¬ ìˆ˜ ê°ì†Œ: RAID degraded ìƒíƒœ\n- ì¦‰ì‹œ Failed ë””ìŠ¤í¬ í™•ì¸ ë° êµì²´ í•„ìš”\n\n**ìœ„í—˜**:\n- RAID 5/6: ì¶”ê°€ ë””ìŠ¤í¬ ì¥ì•  ì‹œ ë°ì´í„° ì†ì‹¤\n- RAID 1/10: ì¤‘ë³µì„± ìƒì‹¤\n\n**ì¡°ì¹˜**:\n1. `cat /proc/mdstat` ìœ¼ë¡œ ìƒíƒœ í™•ì¸\n2. Failed ë””ìŠ¤í¬ ì‹ë³„ ë° êµì²´\n3. RAID rebuild ëª¨ë‹ˆí„°ë§\n\n**ë©”íŠ¸ë¦­**: `node_md_disks{state=\\\"active\\\"}`",
          "gridPos": {"h": 6, "w": 4, "x": 16, "y": 5},
          "targets": [{
            "expr": "count(node_md_disks{state=\"active\"})",
            "refId": "A"
          }],
          "options": {
            "colorMode": "background"
          },
          "fieldConfig": {
            "defaults": {
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "rgba(239, 68, 68, 0.15)"},
                  {"value": 4, "color": "rgba(16, 185, 129, 0.15)"}
                ]
              }
            }
          }
        },
        {
          "type": "bargauge",
          "title": "ë…¸ë“œë³„ CPU ì‚¬ìš©ë¥ ",
          "gridPos": {"h": 6, "w": 4, "x": 20, "y": 5},
          "targets": [{
            "expr": "(1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) by (instance)) * 100",
            "legendFormat": "{{instance}}",
            "refId": "A"
          }],
          "options": {
            "orientation": "horizontal",
            "displayMode": "gradient",
            "showUnfilled": true
          },
          "fieldConfig": {
            "defaults": {
              "unit": "percent",
              "color": {"mode": "continuous-GrYlRd"},
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "#10B981"},
                  {"value": 70, "color": "#F59E0B"},
                  {"value": 85, "color": "#EF4444"}
                ]
              }
            }
          }
        },
        {
          "type": "row",
          "title": "ë„¤íŠ¸ì›Œí¬ ìƒíƒœ",
          "gridPos": {"h": 1, "w": 24, "x": 0, "y": 11},
          "collapsed": false
        },
        {
          "type": "timeseries",
          "title": "ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ (ìˆ˜ì‹ /ì†¡ì‹ )",
          "description": "**ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë³„ Tx/Rx ëŒ€ì—­í­**\n\në„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì˜ ì†¡ì‹ (Transmit) ë° ìˆ˜ì‹ (Receive) ì†ë„ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.\n\n**ì •ìƒ ë²”ìœ„**: ë§í¬ ìš©ëŸ‰ì˜ 70% ì´í•˜\n\n**ë³‘ëª© í˜„ìƒ**:\n- **70-80%**: ì£¼ì˜ í•„ìš”\n- **80% ì´ìƒ**: ë„¤íŠ¸ì›Œí¬ ë³‘ëª©, ì„±ëŠ¥ ì €í•˜ ë°œìƒ\n\n**ì¡°ì¹˜ ì‚¬í•­**:\n- ì§€ì†ì  80% ì´ìƒ: ë„¤íŠ¸ì›Œí¬ ì—…ê·¸ë ˆì´ë“œ ë˜ëŠ” íŠ¸ë˜í”½ ë¶„ì‚°\n- Link Aggregation(LACP) êµ¬ì„± ê²€í† \n- QoS ì •ì±…ìœ¼ë¡œ ì¤‘ìš” íŠ¸ë˜í”½ ìš°ì„ ìˆœìœ„ ë¶€ì—¬\n\n**ë©”íŠ¸ë¦­**: `rate(node_network_transmit_bytes_total[5m])`, `rate(node_network_receive_bytes_total[5m])`",
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 12},
          "targets": [
            {
              "expr": "sum(rate(node_network_receive_bytes_total[5m])) * 8 / 1000000",
              "legendFormat": "ìˆ˜ì‹  (Mbps)",
              "refId": "A"
            },
            {
              "expr": "sum(rate(node_network_transmit_bytes_total[5m])) * 8 / 1000000",
              "legendFormat": "ì†¡ì‹  (Mbps)",
              "refId": "B"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "custom": {
                "drawStyle": "line",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "fillOpacity": 10
              },
              "unit": "Mbits",
              "color": {"mode": "palette-classic"}
            },
            "overrides": [
              {"matcher": {"id": "byName", "options": "ìˆ˜ì‹  (Mbps)"}, "properties": [{"id": "color", "value": {"fixedColor": "#5B8DEE", "mode": "fixed"}}]},
              {"matcher": {"id": "byName", "options": "ì†¡ì‹  (Mbps)"}, "properties": [{"id": "color", "value": {"fixedColor": "#4DB8A8", "mode": "fixed"}}]}
            ]
          }
        },
        {
          "type": "timeseries",
          "title": "íŒ¨í‚· ì†ì‹¤ë¥ ",
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 12},
          "targets": [{
            "expr": "sum(rate(node_network_receive_errs_total[5m])) / sum(rate(node_network_receive_packets_total[5m])) * 100",
            "refId": "A"
          }],
          "fieldConfig": {
            "defaults": {
              "custom": {
                "drawStyle": "line",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "fillOpacity": 10
              },
              "unit": "percent",
              "color": {"mode": "fixed", "fixedColor": "#EF4444"},
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "#10B981"},
                  {"value": 0.1, "color": "#F59E0B"},
                  {"value": 1, "color": "#EF4444"}
                ]
              }
            }
          }
        },
        {
          "type": "row",
          "title": "ìŠ¤í† ë¦¬ì§€ í†µí•© ë·°",
          "gridPos": {"h": 1, "w": 24, "x": 0, "y": 20},
          "collapsed": false
        },
        {
          "type": "bargauge",
          "title": "ìŠ¤í† ë¦¬ì§€ ì‹œìŠ¤í…œë³„ ì‚¬ìš©ë¥ ",
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 21},
          "targets": [
            {
              "expr": "avg(kubelet_volume_stats_used_bytes / kubelet_volume_stats_capacity_bytes) * 100",
              "legendFormat": "Longhorn (K8s)",
              "refId": "A"
            },
            {
              "expr": "avg(ceph_cluster_total_used_bytes / ceph_cluster_total_bytes) * 100",
              "legendFormat": "Ceph (Distributed)",
              "refId": "B"
            },
            {
              "expr": "72",
              "legendFormat": "Isilon (NAS)",
              "refId": "C"
            },
            {
              "expr": "avg(1 - (minio_cluster_capacity_usable_free_bytes / minio_cluster_capacity_usable_total_bytes)) * 100",
              "legendFormat": "MinIO (S3)",
              "refId": "D"
            }
          ],
          "options": {
            "orientation": "horizontal",
            "displayMode": "gradient",
            "showUnfilled": true
          },
          "fieldConfig": {
            "defaults": {
              "unit": "percent",
              "color": {"mode": "continuous-GrYlRd"},
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "#10B981"},
                  {"value": 70, "color": "#F59E0B"},
                  {"value": 85, "color": "#EF4444"}
                ]
              }
            }
          }
        },
        {
          "type": "timeseries",
          "title": "ìŠ¤í† ë¦¬ì§€ I/O í†µí•©",
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 21},
          "targets": [
            {
              "expr": "sum(rate(node_disk_read_bytes_total[5m]))",
              "legendFormat": "Read",
              "refId": "A"
            },
            {
              "expr": "sum(rate(node_disk_written_bytes_total[5m]))",
              "legendFormat": "Write",
              "refId": "B"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "custom": {
                "drawStyle": "line",
                "lineInterpolation": "smooth",
                "lineWidth": 2,
                "fillOpacity": 10
              },
              "unit": "Bps",
              "color": {"mode": "palette-classic"}
            }
          }
        },
        {
          "type": "row",
          "title": "Kubernetes í´ëŸ¬ìŠ¤í„°",
          "gridPos": {"h": 1, "w": 24, "x": 0, "y": 29},
          "collapsed": false
        },
        {
          "type": "stat",
          "title": "Total Pods",
          "gridPos": {"h": 6, "w": 4, "x": 0, "y": 30},
          "targets": [{
            "expr": "sum(kube_pod_status_phase{phase=\"Running\"})",
            "refId": "A"
          }],
          "fieldConfig": {
            "defaults": {
              "color": {"mode": "fixed", "fixedColor": "#5B8DEE"}
            }
          }
        },
        {
          "type": "stat",
          "title": "Total Services",
          "gridPos": {"h": 6, "w": 4, "x": 4, "y": 30},
          "targets": [{
            "expr": "count(kube_service_info)",
            "refId": "A"
          }],
          "fieldConfig": {
            "defaults": {
              "color": {"mode": "fixed", "fixedColor": "#4DB8A8"}
            }
          }
        },
        {
          "type": "stat",
          "title": "Pending Pods",
          "gridPos": {"h": 6, "w": 4, "x": 8, "y": 30},
          "targets": [{
            "expr": "sum(kube_pod_status_phase{phase=\"Pending\"})",
            "refId": "A"
          }],
          "options": {
            "colorMode": "background"
          },
          "fieldConfig": {
            "defaults": {
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "rgba(16, 185, 129, 0.15)"},
                  {"value": 1, "color": "rgba(245, 158, 11, 0.15)"},
                  {"value": 5, "color": "rgba(239, 68, 68, 0.15)"}
                ]
              }
            }
          }
        },
        {
          "type": "stat",
          "title": "Failed Pods",
          "gridPos": {"h": 6, "w": 4, "x": 12, "y": 30},
          "targets": [{
            "expr": "sum(kube_pod_status_phase{phase=\"Failed\"})",
            "refId": "A"
          }],
          "options": {
            "colorMode": "background"
          },
          "fieldConfig": {
            "defaults": {
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {"value": 0, "color": "rgba(16, 185, 129, 0.15)"},
                  {"value": 1, "color": "rgba(239, 68, 68, 0.15)"}
                ]
              }
            }
          }
        },
        {
          "type": "piechart",
          "title": "Pod ë¶„í¬ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„)",
          "gridPos": {"h": 6, "w": 8, "x": 16, "y": 30},
          "targets": [{
            "expr": "sum(kube_pod_status_phase{phase=\"Running\"}) by (namespace)",
            "refId": "A"
          }],
          "options": {
            "legend": {"displayMode": "table", "placement": "right", "values": ["value", "percent"]},
            "pieType": "donut",
            "displayLabels": []
          },
          "fieldConfig": {
            "defaults": {
              "color": {"mode": "palette-classic"}
            }
          }
        },
        {
          "type": "text",
          "title": "",
          "gridPos": {"h": 3, "w": 24, "x": 0, "y": 36},
          "transparent": true,
          "options": {
            "mode": "html",
            "content": "<div style='padding: 12px; background: rgba(31, 41, 55, 0.4); border-radius: 8px; text-align: center;'><a href='/d/dataops-executive-v2/dataops-executive-summary' style='padding: 10px 24px; background: #5B8DEE; color: white; text-decoration: none; border-radius: 6px; font-weight: 500;'>â† Executive Summaryë¡œ ëŒì•„ê°€ê¸°</a></div>"
          }
        }
      ]
    }
