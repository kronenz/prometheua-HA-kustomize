apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-dataops-data-pipeline-ko-v5
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
data:
  dataops-data-pipeline-ko-v5.json: |
    {
      "uid": "dataops-data-ko-v5",
      "title": "DataOps í”Œë«í¼ - ë°ì´í„° íŒŒì´í”„ë¼ì¸",
      "tags": ["dataops", "data", "pipeline", "korean", "v5", "spark"],
      "timezone": "browser",
      "schemaVersion": 39,
      "version": 1,
      "refresh": "30s",
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "panels": [
        {
          "title": "ğŸ“‹ ë°ì´í„° íŒŒì´í”„ë¼ì¸ ê°œìš”",
          "type": "text",
          "gridPos": { "x": 0, "y": 0, "w": 24, "h": 3 },
          "options": {
            "mode": "markdown",
            "content": "# ğŸ”„ DataOps ë°ì´í„° íŒŒì´í”„ë¼ì¸\n\n**Spark ê¸°ë°˜ ë°ì´í„° ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸**ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.\n\n- **Spark í´ëŸ¬ìŠ¤í„° Flow**: Master â†’ Workers â†’ Applications\n- **ë°ì´í„° ì²˜ë¦¬ ì„±ëŠ¥**: Worker CPU/ë©”ëª¨ë¦¬ ì‚¬ìš© ì¶”ì´\n- **íŒŒì´í”„ë¼ì¸ ê±´ê°•ë„**: ì²˜ë¦¬ ì•ˆì •ì„± ë° ì„±ëŠ¥ ì§€í‘œ\n\n---\n\n**ë¹ ë¥¸ ì´ë™**: [ğŸ  í¬í„¸](d/dataops-portal-ko-v5) | [ğŸš€ ë°°í¬](d/dataops-deployment-ko-v5) | [ğŸ’Š ì•± ìƒíƒœ](d/dataops-health-ko-v5) | [ğŸ“Š ë¦¬ì†ŒìŠ¤](d/dataops-capacity-ko-v5) | [âš¡ ì„±ëŠ¥](d/dataops-performance-ko-v5) | [ğŸ”§ ìµœì í™”](d/dataops-optimize-ko-v5)"
          }
        },
        {
          "title": "1ï¸âƒ£ Spark Master ìƒíƒœ",
          "type": "stat",
          "gridPos": { "x": 0, "y": 3, "w": 6, "h": 4 },
          "description": "**Spark Master ë©”íŠ¸ë¦­ ìˆ˜ì§‘**\n\nSpark Masterê°€ ì •ìƒì ìœ¼ë¡œ ë©”íŠ¸ë¦­ì„ ì œê³µí•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "up{namespace=\"spark\",job=\"spark-master\"}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "value": null, "color": "#FADBD8" },
                  { "value": 1, "color": "#D5F4E6" }
                ]
              },
              "unit": "short",
              "mappings": [
                { "type": "value", "value": "1", "text": "ì •ìƒ" },
                { "type": "value", "value": "0", "text": "ë¹„ì •ìƒ" }
              ]
            }
          },
          "options": {
            "graphMode": "none",
            "colorMode": "background",
            "textMode": "value"
          }
        },
        {
          "title": "2ï¸âƒ£ í™œì„± Worker ìˆ˜",
          "type": "stat",
          "gridPos": { "x": 6, "y": 3, "w": 6, "h": 4 },
          "description": "**Spark í™œì„± Worker**\n\në°ì´í„° ì²˜ë¦¬ì— ì‚¬ìš© ê°€ëŠ¥í•œ Worker ë…¸ë“œ ê°œìˆ˜ì…ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "metrics_master_aliveWorkers_Value{namespace=\"spark\"}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "value": null, "color": "#D6EAF8" }
                ]
              },
              "unit": "short"
            }
          },
          "options": {
            "graphMode": "area",
            "colorMode": "background",
            "textMode": "value_and_name"
          }
        },
        {
          "title": "3ï¸âƒ£ ì‹¤í–‰ ì¤‘ì¸ ì•±",
          "type": "stat",
          "gridPos": { "x": 12, "y": 3, "w": 6, "h": 4 },
          "description": "**Spark Application ì‹¤í–‰ ìˆ˜**\n\ní˜„ì¬ ë°ì´í„°ë¥¼ ì²˜ë¦¬ ì¤‘ì¸ Application ê°œìˆ˜ì…ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "metrics_master_apps_Value{namespace=\"spark\"}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "value": null, "color": "#B8E0D2" }
                ]
              },
              "unit": "short"
            }
          },
          "options": {
            "graphMode": "area",
            "colorMode": "background",
            "textMode": "value_and_name"
          }
        },
        {
          "title": "4ï¸âƒ£ ì½”ë“œ ìƒì„± ì„±ëŠ¥",
          "type": "stat",
          "gridPos": { "x": 18, "y": 3, "w": 6, "h": 4 },
          "description": "**SQL ì½”ë“œ ìƒì„± ì‹œê°„**\n\nSpark SQLì˜ ì½”ë“œ ìƒì„± ì„±ëŠ¥ (95th Percentile)ì…ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "metrics_CodeGenerator_compilationTime_95thPercentile{namespace=\"spark\"}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "value": null, "color": "#D5F4E6" },
                  { "value": 100, "color": "#FCF3CF" },
                  { "value": 500, "color": "#FADBD8" }
                ]
              },
              "unit": "ms",
              "decimals": 2
            }
          },
          "options": {
            "graphMode": "area",
            "colorMode": "background",
            "textMode": "value_and_name"
          }
        },
        {
          "title": "ğŸ”„ Spark ë°ì´í„° ì²˜ë¦¬ Flow",
          "type": "text",
          "gridPos": { "x": 0, "y": 7, "w": 24, "h": 6 },
          "options": {
            "mode": "markdown",
            "content": "```mermaid\ngraph LR\n    A[\"ğŸ¯ Spark Master<br/>(ë©”íŠ¸ë¦­ ì œê³µ)\"] -->|ê´€ë¦¬| B[\"âš™ï¸ Worker 1<br/>(ë°ì´í„° ì²˜ë¦¬)\"]\n    A -->|ê´€ë¦¬| C[\"âš™ï¸ Worker 2<br/>(ë°ì´í„° ì²˜ë¦¬)\"]\n    B -->|ì‹¤í–‰| D[\"ğŸ“¦ Application<br/>(ì‘ì—… ìˆ˜í–‰)\"]\n    C -->|ì‹¤í–‰| D\n    D -->|ê²°ê³¼| E[\"ğŸ“Š ë°ì´í„° ì¶œë ¥<br/>(S3/HDFS)\"]\n    \n    style A fill:#D6EAF8,stroke:#3498DB,stroke-width:2px\n    style B fill:#B8E0D2,stroke:#27AE60,stroke-width:2px\n    style C fill:#B8E0D2,stroke:#27AE60,stroke-width:2px\n    style D fill:#FCF3CF,stroke:#F39C12,stroke-width:2px\n    style E fill:#E8DAEF,stroke:#9B59B6,stroke-width:2px\n```\n\n**ë°ì´í„° ì²˜ë¦¬ íë¦„**:\n1. **Spark Master**: í´ëŸ¬ìŠ¤í„° ì „ì²´ ê´€ë¦¬ ë° ë¦¬ì†ŒìŠ¤ í• ë‹¹\n2. **Workers**: ì‹¤ì œ ë°ì´í„° ì²˜ë¦¬ ìˆ˜í–‰ (ë¶„ì‚° ë³‘ë ¬ ì²˜ë¦¬)\n3. **Applications**: ì‚¬ìš©ì ì‘ì—… ì‹¤í–‰ (Spark Jobs)\n4. **ë°ì´í„° ì¶œë ¥**: ì²˜ë¦¬ ê²°ê³¼ë¥¼ S3, HDFS ë“±ì— ì €ì¥"
          }
        },
        {
          "title": "ğŸ“ˆ Spark Worker CPU ì‚¬ìš©ë¥ ",
          "type": "timeseries",
          "gridPos": { "x": 0, "y": 13, "w": 12, "h": 8 },
          "description": "**Spark Workerì˜ CPU ì‚¬ìš© ì¶”ì´**\n\nWorker Podì˜ CPU ì‚¬ìš©ë¥ ì„ ì‹œê°„ì— ë”°ë¼ ì¶”ì í•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "rate(container_cpu_usage_seconds_total{namespace=\"spark\",pod=~\".*worker.*\",container!=\"\",container!=\"POD\"}[5m])",
              "legendFormat": "{{pod}}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "lineWidth": 2,
                "fillOpacity": 20,
                "pointSize": 5,
                "spanNulls": true
              },
              "unit": "percentunit"
            }
          },
          "options": {
            "legend": {
              "displayMode": "table",
              "placement": "right",
              "showLegend": true,
              "calcs": ["lastNotNull", "max", "mean"]
            }
          }
        },
        {
          "title": "ğŸ’¾ Spark Worker ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰",
          "type": "timeseries",
          "gridPos": { "x": 12, "y": 13, "w": 12, "h": 8 },
          "description": "**Spark Workerì˜ ë©”ëª¨ë¦¬ ì‚¬ìš© ì¶”ì´**\n\nWorker Podì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì‹œê°„ì— ë”°ë¼ ì¶”ì í•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "container_memory_working_set_bytes{namespace=\"spark\",pod=~\".*worker.*\",container!=\"\",container!=\"POD\"}",
              "legendFormat": "{{pod}}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "lineWidth": 2,
                "fillOpacity": 20,
                "pointSize": 5,
                "spanNulls": true
              },
              "unit": "bytes"
            }
          },
          "options": {
            "legend": {
              "displayMode": "table",
              "placement": "right",
              "showLegend": true,
              "calcs": ["lastNotNull", "max", "mean"]
            }
          }
        },
        {
          "title": "ğŸŒ Spark Worker ë„¤íŠ¸ì›Œí¬ ìˆ˜ì‹ ",
          "type": "timeseries",
          "gridPos": { "x": 0, "y": 21, "w": 12, "h": 8 },
          "description": "**Worker ë„¤íŠ¸ì›Œí¬ ìˆ˜ì‹  ì†ë„**\n\nWorkerê°€ ë°ì´í„°ë¥¼ ë°›ëŠ” ì†ë„ë¥¼ ì¶”ì í•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "rate(container_network_receive_bytes_total{namespace=\"spark\",pod=~\".*worker.*\"}[5m])",
              "legendFormat": "{{pod}}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "lineWidth": 2,
                "fillOpacity": 10,
                "pointSize": 5,
                "spanNulls": true
              },
              "unit": "Bps"
            }
          },
          "options": {
            "legend": {
              "displayMode": "table",
              "placement": "right",
              "showLegend": true,
              "calcs": ["lastNotNull", "max", "mean"]
            }
          }
        },
        {
          "title": "ğŸ“¡ Spark Worker ë„¤íŠ¸ì›Œí¬ ì „ì†¡",
          "type": "timeseries",
          "gridPos": { "x": 12, "y": 21, "w": 12, "h": 8 },
          "description": "**Worker ë„¤íŠ¸ì›Œí¬ ì „ì†¡ ì†ë„**\n\nWorkerê°€ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ì†ë„ë¥¼ ì¶”ì í•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "rate(container_network_transmit_bytes_total{namespace=\"spark\",pod=~\".*worker.*\"}[5m])",
              "legendFormat": "{{pod}}",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "lineWidth": 2,
                "fillOpacity": 10,
                "pointSize": 5,
                "spanNulls": true
              },
              "unit": "Bps"
            }
          },
          "options": {
            "legend": {
              "displayMode": "table",
              "placement": "right",
              "showLegend": true,
              "calcs": ["lastNotNull", "max", "mean"]
            }
          }
        },
        {
          "title": "ğŸ”¢ Spark Pods ìƒíƒœ",
          "type": "table",
          "gridPos": { "x": 0, "y": 29, "w": 12, "h": 8 },
          "description": "**Spark ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ Pod ëª©ë¡**\n\nMaster, Worker, Application Podì˜ ìƒíƒœë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "kube_pod_info{namespace=\"spark\"}",
              "format": "table",
              "instant": true,
              "refId": "A"
            },
            {
              "expr": "kube_pod_status_phase{namespace=\"spark\"}",
              "format": "table",
              "instant": true,
              "refId": "B"
            }
          ],
          "transformations": [
            {
              "id": "merge",
              "options": {}
            },
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "Time": true,
                  "job": true,
                  "instance": true,
                  "uid": true,
                  "created_by_kind": true,
                  "created_by_name": true,
                  "host_ip": true,
                  "host_network": true,
                  "pod_ip": true,
                  "priority_class": true,
                  "Value #A": true
                },
                "renameByName": {
                  "pod": "Pod",
                  "node": "Node",
                  "phase": "Status"
                }
              }
            }
          ],
          "options": {
            "showHeader": true,
            "cellHeight": "sm",
            "footer": {
              "show": false
            }
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "align": "left"
              }
            },
            "overrides": [
              {
                "matcher": { "id": "byName", "options": "Status" },
                "properties": [
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "type": "color-background"
                    }
                  },
                  {
                    "id": "mappings",
                    "value": [
                      { "type": "value", "value": "Running", "text": "Running", "color": "#D5F4E6" },
                      { "type": "value", "value": "Pending", "text": "Pending", "color": "#FCF3CF" },
                      { "type": "value", "value": "Failed", "text": "Failed", "color": "#FADBD8" },
                      { "type": "value", "value": "Succeeded", "text": "Succeeded", "color": "#E8DAEF" }
                    ]
                  }
                ]
              }
            ]
          }
        },
        {
          "title": "ğŸ”„ Spark Container ì¬ì‹œì‘ ë‚´ì—­",
          "type": "table",
          "gridPos": { "x": 12, "y": 29, "w": 12, "h": 8 },
          "description": "**Spark Container ì¬ì‹œì‘ íšŸìˆ˜**\n\nSpark ë„¤ì„ìŠ¤í˜ì´ìŠ¤ Containerì˜ ì¬ì‹œì‘ íšŸìˆ˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "kube_pod_container_status_restarts_total{namespace=\"spark\"} > 0",
              "format": "table",
              "instant": true,
              "refId": "A"
            }
          ],
          "transformations": [
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "Time": true,
                  "job": true,
                  "instance": true,
                  "uid": true
                },
                "renameByName": {
                  "pod": "Pod",
                  "container": "Container",
                  "Value": "Restarts"
                }
              }
            }
          ],
          "options": {
            "showHeader": true,
            "cellHeight": "sm",
            "footer": {
              "show": true,
              "reducer": ["sum"]
            }
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "align": "left"
              }
            },
            "overrides": [
              {
                "matcher": { "id": "byName", "options": "Restarts" },
                "properties": [
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "type": "color-background"
                    }
                  },
                  {
                    "id": "thresholds",
                    "value": {
                      "mode": "absolute",
                      "steps": [
                        { "value": null, "color": "#D5F4E6" },
                        { "value": 3, "color": "#FCF3CF" },
                        { "value": 10, "color": "#FADBD8" }
                      ]
                    }
                  }
                ]
              }
            ]
          }
        },
        {
          "title": "ğŸ“Š Spark í´ëŸ¬ìŠ¤í„° ê±´ê°•ë„ ìš”ì•½",
          "type": "timeseries",
          "gridPos": { "x": 0, "y": 37, "w": 24, "h": 8 },
          "description": "**Spark í´ëŸ¬ìŠ¤í„° ì „ë°˜ì ì¸ ê±´ê°•ë„**\n\nWorker ìˆ˜, Application ìˆ˜, ì •ìƒ Pod ë¹„ìœ¨ì„ í•œëˆˆì— í™•ì¸í•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "metrics_master_aliveWorkers_Value{namespace=\"spark\"}",
              "legendFormat": "í™œì„± Workers",
              "refId": "A"
            },
            {
              "expr": "metrics_master_apps_Value{namespace=\"spark\"}",
              "legendFormat": "ì‹¤í–‰ ì¤‘ì¸ Apps",
              "refId": "B"
            },
            {
              "expr": "count(kube_pod_status_phase{namespace=\"spark\",phase=\"Running\"}) / count(kube_pod_info{namespace=\"spark\"}) * 10",
              "legendFormat": "ì •ìƒ Pod ë¹„ìœ¨ (x10)",
              "refId": "C"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "lineWidth": 3,
                "fillOpacity": 30,
                "pointSize": 5,
                "spanNulls": true
              },
              "unit": "short"
            },
            "overrides": [
              {
                "matcher": { "id": "byName", "options": "í™œì„± Workers" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#D6EAF8", "mode": "fixed" } }]
              },
              {
                "matcher": { "id": "byName", "options": "ì‹¤í–‰ ì¤‘ì¸ Apps" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#B8E0D2", "mode": "fixed" } }]
              },
              {
                "matcher": { "id": "byName", "options": "ì •ìƒ Pod ë¹„ìœ¨ (x10)" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#D5F4E6", "mode": "fixed" } }]
              }
            ]
          },
          "options": {
            "legend": {
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            }
          }
        }
      ]
    }
