apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-dataops-resource-capacity-ko-v5
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
data:
  dataops-resource-capacity-ko-v5.json: |
    {
      "uid": "dataops-capacity-ko-v5",
      "title": "DataOps í”Œë«í¼ - ë¦¬ì†ŒìŠ¤ ìš©ëŸ‰",
      "tags": ["dataops", "capacity", "resources", "korean", "v5", "kubernetes"],
      "timezone": "browser",
      "schemaVersion": 39,
      "version": 1,
      "refresh": "30s",
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "panels": [
        {
          "title": "ğŸ“‹ ë¦¬ì†ŒìŠ¤ ìš©ëŸ‰ ê°œìš”",
          "type": "text",
          "gridPos": { "x": 0, "y": 0, "w": 24, "h": 3 },
          "options": {
            "mode": "markdown",
            "content": "# ğŸ“Š DataOps ë¦¬ì†ŒìŠ¤ ìš©ëŸ‰ ê´€ë¦¬\n\n**í´ëŸ¬ìŠ¤í„° ì „ì²´ì˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰**ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.\n\n- **CPU/ë©”ëª¨ë¦¬ í• ë‹¹**: ìš”ì²­(Request) ë° ì œí•œ(Limit) ì¶”ì \n- **ë…¸ë“œ ìš©ëŸ‰**: ê° ë…¸ë“œì˜ ê°€ìš© ë¦¬ì†ŒìŠ¤ ë¶„ì„\n- **ìŠ¤í† ë¦¬ì§€**: PVC ì‚¬ìš©ëŸ‰ ë° ìš©ëŸ‰ ê³„íš\n\n---\n\n**ë¹ ë¥¸ ì´ë™**: [ğŸ  í¬í„¸](d/dataops-portal-ko-v5) | [ğŸš€ ë°°í¬](d/dataops-deployment-ko-v5) | [ğŸ’Š ì•± ìƒíƒœ](d/dataops-health-ko-v5) | [âš¡ ì„±ëŠ¥](d/dataops-performance-ko-v5) | [ğŸ”„ ë°ì´í„°](d/dataops-data-ko-v5) | [ğŸ”§ ìµœì í™”](d/dataops-optimize-ko-v5)"
          }
        },
        {
          "title": "1ï¸âƒ£ CPU í• ë‹¹ë¥ ",
          "type": "stat",
          "gridPos": { "x": 0, "y": 3, "w": 6, "h": 4 },
          "description": "**CPU Request í• ë‹¹ë¥ **\n\nì „ì²´ CPU ìš©ëŸ‰ ëŒ€ë¹„ Requestë¡œ í• ë‹¹ëœ ë¹„ìœ¨ì…ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\"}) / sum(kube_node_status_allocatable{resource=\"cpu\"}) * 100",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "value": null, "color": "#D5F4E6" },
                  { "value": 70, "color": "#FCF3CF" },
                  { "value": 85, "color": "#FADBD8" }
                ]
              },
              "unit": "percent",
              "decimals": 1
            }
          },
          "options": {
            "graphMode": "area",
            "colorMode": "background",
            "textMode": "value_and_name"
          }
        },
        {
          "title": "2ï¸âƒ£ ë©”ëª¨ë¦¬ í• ë‹¹ë¥ ",
          "type": "stat",
          "gridPos": { "x": 6, "y": 3, "w": 6, "h": 4 },
          "description": "**ë©”ëª¨ë¦¬ Request í• ë‹¹ë¥ **\n\nì „ì²´ ë©”ëª¨ë¦¬ ìš©ëŸ‰ ëŒ€ë¹„ Requestë¡œ í• ë‹¹ëœ ë¹„ìœ¨ì…ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\"}) / sum(kube_node_status_allocatable{resource=\"memory\"}) * 100",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "value": null, "color": "#D5F4E6" },
                  { "value": 70, "color": "#FCF3CF" },
                  { "value": 85, "color": "#FADBD8" }
                ]
              },
              "unit": "percent",
              "decimals": 1
            }
          },
          "options": {
            "graphMode": "area",
            "colorMode": "background",
            "textMode": "value_and_name"
          }
        },
        {
          "title": "3ï¸âƒ£ CPU ì‹¤ì œ ì‚¬ìš©ë¥ ",
          "type": "stat",
          "gridPos": { "x": 12, "y": 3, "w": 6, "h": 4 },
          "description": "**ì‹¤ì œ CPU ì‚¬ìš©ë¥ **\n\nì „ì²´ ë…¸ë“œì˜ ì‹¤ì œ CPU ì‚¬ìš©ë¥ ì…ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "(1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m]))) * 100",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "value": null, "color": "#D5F4E6" },
                  { "value": 70, "color": "#FCF3CF" },
                  { "value": 90, "color": "#FADBD8" }
                ]
              },
              "unit": "percent",
              "decimals": 1
            }
          },
          "options": {
            "graphMode": "area",
            "colorMode": "background",
            "textMode": "value_and_name"
          }
        },
        {
          "title": "4ï¸âƒ£ ë©”ëª¨ë¦¬ ì‹¤ì œ ì‚¬ìš©ë¥ ",
          "type": "stat",
          "gridPos": { "x": 18, "y": 3, "w": 6, "h": 4 },
          "description": "**ì‹¤ì œ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ **\n\nì „ì²´ ë…¸ë“œì˜ ì‹¤ì œ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì…ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "(1 - sum(node_memory_MemAvailable_bytes) / sum(node_memory_MemTotal_bytes)) * 100",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  { "value": null, "color": "#D5F4E6" },
                  { "value": 70, "color": "#FCF3CF" },
                  { "value": 90, "color": "#FADBD8" }
                ]
              },
              "unit": "percent",
              "decimals": 1
            }
          },
          "options": {
            "graphMode": "area",
            "colorMode": "background",
            "textMode": "value_and_name"
          }
        },
        {
          "title": "ğŸ“ˆ CPU í• ë‹¹ vs ì‚¬ìš© ì¶”ì´",
          "type": "timeseries",
          "gridPos": { "x": 0, "y": 7, "w": 12, "h": 8 },
          "description": "**CPU í• ë‹¹ ë° ì‚¬ìš© í˜„í™©**\n\nRequest í• ë‹¹ëŸ‰ê³¼ ì‹¤ì œ ì‚¬ìš©ëŸ‰ì„ ë¹„êµí•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\"}) / sum(kube_node_status_allocatable{resource=\"cpu\"}) * 100",
              "legendFormat": "CPU Request %",
              "refId": "A"
            },
            {
              "expr": "(1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[5m]))) * 100",
              "legendFormat": "CPU ì‹¤ì œ ì‚¬ìš©ë¥  %",
              "refId": "B"
            },
            {
              "expr": "sum(kube_pod_container_resource_limits{resource=\"cpu\"}) / sum(kube_node_status_allocatable{resource=\"cpu\"}) * 100",
              "legendFormat": "CPU Limit %",
              "refId": "C"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "lineWidth": 2,
                "fillOpacity": 20,
                "pointSize": 5,
                "spanNulls": true
              },
              "unit": "percent"
            },
            "overrides": [
              {
                "matcher": { "id": "byName", "options": "CPU Request %" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#D6EAF8", "mode": "fixed" } }]
              },
              {
                "matcher": { "id": "byName", "options": "CPU ì‹¤ì œ ì‚¬ìš©ë¥  %" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#B8E0D2", "mode": "fixed" } }]
              },
              {
                "matcher": { "id": "byName", "options": "CPU Limit %" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#FADBD8", "mode": "fixed" } }]
              }
            ]
          },
          "options": {
            "legend": {
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            }
          }
        },
        {
          "title": "ğŸ“Š ë©”ëª¨ë¦¬ í• ë‹¹ vs ì‚¬ìš© ì¶”ì´",
          "type": "timeseries",
          "gridPos": { "x": 12, "y": 7, "w": 12, "h": 8 },
          "description": "**ë©”ëª¨ë¦¬ í• ë‹¹ ë° ì‚¬ìš© í˜„í™©**\n\nRequest í• ë‹¹ëŸ‰ê³¼ ì‹¤ì œ ì‚¬ìš©ëŸ‰ì„ ë¹„êµí•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\"}) / sum(kube_node_status_allocatable{resource=\"memory\"}) * 100",
              "legendFormat": "Memory Request %",
              "refId": "A"
            },
            {
              "expr": "(1 - sum(node_memory_MemAvailable_bytes) / sum(node_memory_MemTotal_bytes)) * 100",
              "legendFormat": "Memory ì‹¤ì œ ì‚¬ìš©ë¥  %",
              "refId": "B"
            },
            {
              "expr": "sum(kube_pod_container_resource_limits{resource=\"memory\"}) / sum(kube_node_status_allocatable{resource=\"memory\"}) * 100",
              "legendFormat": "Memory Limit %",
              "refId": "C"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "lineWidth": 2,
                "fillOpacity": 20,
                "pointSize": 5,
                "spanNulls": true
              },
              "unit": "percent"
            },
            "overrides": [
              {
                "matcher": { "id": "byName", "options": "Memory Request %" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#E8DAEF", "mode": "fixed" } }]
              },
              {
                "matcher": { "id": "byName", "options": "Memory ì‹¤ì œ ì‚¬ìš©ë¥  %" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#FCF3CF", "mode": "fixed" } }]
              },
              {
                "matcher": { "id": "byName", "options": "Memory Limit %" },
                "properties": [{ "id": "color", "value": { "fixedColor": "#FADBD8", "mode": "fixed" } }]
              }
            ]
          },
          "options": {
            "legend": {
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            }
          }
        },
        {
          "title": "ğŸ–¥ï¸ ë…¸ë“œë³„ CPU ìš©ëŸ‰",
          "type": "table",
          "gridPos": { "x": 0, "y": 15, "w": 12, "h": 8 },
          "description": "**ê° ë…¸ë“œì˜ CPU ë¦¬ì†ŒìŠ¤**\n\në…¸ë“œë³„ CPU í• ë‹¹ ê°€ëŠ¥ ìš©ëŸ‰ê³¼ Request í• ë‹¹ëŸ‰ì„ í‘œì‹œí•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "kube_node_status_allocatable{resource=\"cpu\"}",
              "format": "table",
              "instant": true,
              "refId": "A"
            },
            {
              "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\"}) by (node)",
              "format": "table",
              "instant": true,
              "refId": "B"
            }
          ],
          "transformations": [
            {
              "id": "merge",
              "options": {}
            },
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "Time": true,
                  "job": true,
                  "instance": true,
                  "resource": true
                },
                "renameByName": {
                  "node": "Node",
                  "Value #A": "Allocatable (Cores)",
                  "Value #B": "Requested (Cores)"
                }
              }
            }
          ],
          "options": {
            "showHeader": true,
            "cellHeight": "sm",
            "footer": {
              "show": false
            }
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "align": "left"
              },
              "decimals": 2
            }
          }
        },
        {
          "title": "ğŸ’¾ ë…¸ë“œë³„ ë©”ëª¨ë¦¬ ìš©ëŸ‰",
          "type": "table",
          "gridPos": { "x": 12, "y": 15, "w": 12, "h": 8 },
          "description": "**ê° ë…¸ë“œì˜ ë©”ëª¨ë¦¬ ë¦¬ì†ŒìŠ¤**\n\në…¸ë“œë³„ ë©”ëª¨ë¦¬ í• ë‹¹ ê°€ëŠ¥ ìš©ëŸ‰ê³¼ Request í• ë‹¹ëŸ‰ì„ í‘œì‹œí•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "kube_node_status_allocatable{resource=\"memory\"}",
              "format": "table",
              "instant": true,
              "refId": "A"
            },
            {
              "expr": "sum(kube_pod_container_resource_requests{resource=\"memory\"}) by (node)",
              "format": "table",
              "instant": true,
              "refId": "B"
            }
          ],
          "transformations": [
            {
              "id": "merge",
              "options": {}
            },
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "Time": true,
                  "job": true,
                  "instance": true,
                  "resource": true
                },
                "renameByName": {
                  "node": "Node",
                  "Value #A": "Allocatable (Bytes)",
                  "Value #B": "Requested (Bytes)"
                }
              }
            }
          ],
          "options": {
            "showHeader": true,
            "cellHeight": "sm",
            "footer": {
              "show": false
            }
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "align": "left"
              },
              "unit": "bytes"
            }
          }
        },
        {
          "title": "ğŸ’¿ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ PVC ì‚¬ìš©ëŸ‰",
          "type": "table",
          "gridPos": { "x": 0, "y": 23, "w": 12, "h": 8 },
          "description": "**PVC ìŠ¤í† ë¦¬ì§€ ì‚¬ìš© í˜„í™©**\n\nê° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ PVC ìš©ëŸ‰ì„ í‘œì‹œí•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "sum(kube_persistentvolumeclaim_resource_requests_storage_bytes) by (namespace)",
              "format": "table",
              "instant": true,
              "refId": "A"
            }
          ],
          "transformations": [
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "Time": true,
                  "job": true,
                  "instance": true
                },
                "renameByName": {
                  "namespace": "Namespace",
                  "Value": "Storage Requested"
                }
              }
            }
          ],
          "options": {
            "showHeader": true,
            "cellHeight": "sm",
            "footer": {
              "show": true,
              "reducer": ["sum"]
            }
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "align": "left"
              },
              "unit": "bytes"
            }
          }
        },
        {
          "title": "ğŸ“¦ Podë³„ ë¦¬ì†ŒìŠ¤ í• ë‹¹ Top 10 (CPU)",
          "type": "table",
          "gridPos": { "x": 12, "y": 23, "w": 12, "h": 8 },
          "description": "**CPUë¥¼ ê°€ì¥ ë§ì´ ìš”ì²­í•œ Pod**\n\nCPU Requestê°€ ë†’ì€ ìƒìœ„ 10ê°œ Podë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "topk(10, sum(kube_pod_container_resource_requests{resource=\"cpu\"}) by (namespace, pod))",
              "format": "table",
              "instant": true,
              "refId": "A"
            }
          ],
          "transformations": [
            {
              "id": "organize",
              "options": {
                "excludeByName": {
                  "Time": true,
                  "job": true,
                  "instance": true
                },
                "renameByName": {
                  "namespace": "Namespace",
                  "pod": "Pod",
                  "Value": "CPU Request (Cores)"
                }
              }
            }
          ],
          "options": {
            "showHeader": true,
            "cellHeight": "sm",
            "footer": {
              "show": false
            }
          },
          "fieldConfig": {
            "defaults": {
              "custom": {
                "align": "left"
              },
              "decimals": 2
            },
            "overrides": [
              {
                "matcher": { "id": "byName", "options": "CPU Request (Cores)" },
                "properties": [
                  {
                    "id": "custom.cellOptions",
                    "value": {
                      "type": "color-background"
                    }
                  },
                  {
                    "id": "thresholds",
                    "value": {
                      "mode": "absolute",
                      "steps": [
                        { "value": null, "color": "#D5F4E6" },
                        { "value": 0.5, "color": "#FCF3CF" },
                        { "value": 1, "color": "#FADBD8" }
                      ]
                    }
                  }
                ]
              }
            ]
          }
        },
        {
          "title": "ğŸ§® ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ CPU/ë©”ëª¨ë¦¬ í• ë‹¹",
          "type": "timeseries",
          "gridPos": { "x": 0, "y": 31, "w": 24, "h": 8 },
          "description": "**ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ ë¦¬ì†ŒìŠ¤ ìš”ì²­ëŸ‰**\n\nê° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ CPU ë° ë©”ëª¨ë¦¬ Requestë¥¼ ì¶”ì í•©ë‹ˆë‹¤.",
          "targets": [
            {
              "expr": "sum(kube_pod_container_resource_requests{resource=\"cpu\"}) by (namespace)",
              "legendFormat": "{{namespace}} (CPU)",
              "refId": "A"
            }
          ],
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": {
                "lineWidth": 2,
                "fillOpacity": 10,
                "pointSize": 5,
                "spanNulls": true
              },
              "unit": "short"
            }
          },
          "options": {
            "legend": {
              "displayMode": "table",
              "placement": "right",
              "showLegend": true,
              "calcs": ["lastNotNull", "max"]
            }
          }
        }
      ]
    }
